---
// src/pages/index.astro
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// Get the 5 most recent publications
const recentWriting = (await getCollection('writing')).sort(
  (a, b) => {
    // Use pubDate if available, otherwise fall back to year
    const aDate = a.data.pubDate ? a.data.pubDate.valueOf() : new Date(a.data.year, 0, 1).valueOf();
    const bDate = b.data.pubDate ? b.data.pubDate.valueOf() : new Date(b.data.year, 0, 1).valueOf();
    return bDate - aDate;
  }
).slice(0, 5);
---
<BaseLayout title="Stephen Butterfill | Home">
  <div class="p-8">
    <h2 class="text-2xl font-bold mb-4">Recent Writing</h2>
    <ul>
      {recentWriting.map(item => (
        <li class="mb-2">
          <a href={`/writing/${item.slug}/`} class="text-blue-600 dark:text-blue-400 hover:underline">
            {item.data.title} ({item.data.year})
          </a>
        </li>
      ))}
    </ul>
    <!-- We will add the sidebar and other sections here later -->
  </div>
</BaseLayout>